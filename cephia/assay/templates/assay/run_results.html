{% extends "cephia/base.html" %}
{% load bootstrap3 %}
{% load el_pagination_tags %}

{% block filter_col_a %}
  {% bootstrap_field filter_form.specimen_label %}
{% endblock %}

{% block page_content %}

{% paginate run_results %}
<div class="container">
  <div class="row">
    <div class="panel panel-default" style="box-shadow: 10px 10px 5px #888888;">
      <div class="panel-heading">
        <h3 class="panel-title">Run({{run.run_date}}) - {{run_results.0.assay.name}} - {{run_results.0.panel.name}}</h3>
      </div>
      <div class="panel-body">
        <div class="row">
          <div class="container"
               {% show_pages %}
               <div class="btn-group">
                 <a href="{% url 'assay:run_results' run_id=run.id %}?csv=1&specific=1" name="specific" class="btn btn-default" style="text-decoration:none;">Export full results</a>
               </div>
               <div class="btn-group">
                 <a href="{% url 'assay:run_results' run_id=run.id %}?csv=1&generic=1" name="generic" class="btn btn-default" style="text-decoration:none;">Export generic results</a>
               </div>
               <div class="table-responsive">
                 <table class="table-striped table table-hover" style="overflow:auto;">
                   <thead>
                     <th>Specimen Label</th>
                     <th>Days from EDDI</th>
                     <th>Days from LP DDI</th>
                     <th>VL</th>
                     <th>Subject Country</th>
                     <th>Subtype</th>
                     <th>ART Naive</th>
                     <th>On ART</th>
                     <th>Test Date</th>
                     <th>Result</th>
                     <th>Method</th>
                     <th>Warning Message</th>
                   </thead>
                   <tbody>
                     {% for result in run_results %}
                     <tr>
                       <td data-result-id="{{result.id}}" ><a class="view-specific-results">{{result.specimen.specimen_label}}</a></td>
                       <td>{{result.specimen.visit.visit_eddi.days_since_eddi}}</td>
                       <td>{{result.specimen.visit.visit_eddi.days_since_lp_ddi}}</td>
                       <td>{{result.specimen.visit.vl}}</td>
                       <td>{{result.specimen.subject.country.code}}</td>
                       <td>{{result.specimen.subject.subtype.name}}</td>
                       <td>{% if result.specimen.visit.treatment_naive %}{% bootstrap_icon "ok" %}{% else %}{% bootstrap_icon "remove" %}{% endif %}</td>
                       <td>{% if result.specimen.visit.on_treatment %}{% bootstrap_icon "ok" %}{% else %}{% bootstrap_icon "remove" %}{% endif %}</td>
                       <td>{{result.test_date}}</td>
                       <td>{{result.result}}</td>
                       <td>{{result.method}}</td>
                       <td>{{result.warning_msg}}</td>
                     </tr>
                     {% endfor %}
                   </tbody>
                 </table>
               </div>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="result-modal-container">
</div>
{% endblock %}
