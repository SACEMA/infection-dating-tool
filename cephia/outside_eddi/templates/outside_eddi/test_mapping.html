{% extends 'outside_eddi/base.html' %}
{% load bootstrap3 %}
{% load js_reverse %}

{% block extrajs%}
  <script src="http://malsup.github.com/jquery.form.js"></script>
  <script src="{% url 'js_reverse' %}" type="text/javascript"></script>
{% endblock %}

{% block content %}
  <div class="container">

    <table class="table table-condensed table-striped">
      <thead>
        <tr>
          <th>Code</th>
          <th>Test</th>
          <th>Property</th>
        </tr>
      </thead>
      <tbody>
        {% for code in codes %}
          <tr>
            <form name="tests" method="post" enctype="multipart/form-data">{% csrf_token %}
              <td>
                {{ code }}
                {{ form.code }}
              </td>
              <td>
                {{ form.test }}
              </td>
              <td>
                {{ form.test_property }}
                <a class="btn btn-primary js-show-properties" id="btn" onclick="showElements(this.form);" data-toggle="modal" data-target="#modal" href="{% url 'outside_eddi:test_properties' test.id %}">Properties</a>
              </td>
            </form>
          </tr>
          {% endfor %}
      </tbody>
    </table>

    <div class="modal fade" id="modal"></div>
    <script>
     $('.js-show-properties').click(function(event) {
         event.preventDefault();
         url = $(this).attr('href');
         var choice = $("#id_test").find('option:selected').attr("value");

         if (!choice){
             alert('Please select a test')
             $(this).attr('data-toggle', '')
         }
         else {
             url = Urls["outside_eddi:test_properties"](choice)

             $.get(url).done(function(html) {
                 $('#modal').html(html);
                 $('#modal').modal();
             });
         }
     });
    </script>

  </div>
{% endblock %}
