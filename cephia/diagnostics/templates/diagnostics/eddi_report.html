{% extends "cephia/base.html" %}
{% load bootstrap3 %}
{% load endless %}

{% block filter_col_a %}
{% bootstrap_field form.subject_label %}
{% bootstrap_field form.source_study %}
{% endblock %}

{% block page_content %}

{% paginate subjects %}

<div class="container">
  <div class="row">
    <div class="panel panel-default" style="box-shadow: 10px 10px 5px #888888;">
      <div class="panel-heading">
        <h3 class="panel-title">EDDI - Subjects</h3>
      </div>
      <div class="panel-body">
        {% show_pages %}
        <div class="row">
          <div class="table-responsive">
            <table class="table-striped table table-hover" style="overflow:auto;">
              <thead>
                <th>Subject Label</th>
                <th>TCI Begin</th>
                <th>TCI End</th>
                <th>EDDI</th>
                <th>Cohort Entry Date</th>
                <th>Cohort Entry Status</th>
                <th>Reported FP Date</th>
                <th>Reported LN Date</th>
                <th></th>
              </thead>
              <tbody>
                {% for subject in subjects %}
                <tr data-subject-id="{{subject.id}}" >
	          <td>{{subject.subject_label}}</td>
	          <td>{{subject.subject_eddi.tci_begin}}</td>
	          <td>{{subject.subject_eddi.tci_end}}</td>
	          <td>{{subject.subject_eddi.eddi}}</td>
                  <td>{{subject.cohort_entry_date}}</td>
                  <td>{{subject.cohort_entry_hiv_status}}</td>
                  <td>{{subject.last_negative_date}}</td>
                  <td>{{subject.first_positive_date}}</td>
                  <td><a class="show-eddi-detail">See detail</a></td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="container">
  <div class="modal fade" id="eddiModal">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
          <h4 class="modal-title">All test history for selected subject</h4>
        </div>
        <div class="modal-body eddi-modal-body">
          <div class="table-responsive" style="overflow:auto; max-height:500px;"">
            <table class="table-striped table table-hover">
              <thead>
                <th>Test Name</th>
                <th>Subject Label</th>
                <th>LN Date</th>
                <th>FP Date</th>
                <th>Test Date</th>
                <th>Adjusted Date</th>
                <th>Test Result</th>
                <th>Study</th>
              </thead>
              <tbody class="eddi-modal">
              </tbody>
            </table>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
